# 🔬 Automated Malware Analysis Tool 🔬

![Malware Analysis](https://img.shields.io/badge/Security-Malware%20Analysis-red)
![Python](https://img.shields.io/badge/Python-3.6+-blue)
![License](https://img.shields.io/badge/License-MIT-green)

## 📋 Overview

This tool provides automated dynamic analysis of potentially malicious executables in a controlled environment. It monitors and records various behaviors of the malware sample including:

- 🌐 Network communications (HTTP/HTTPS requests, DNS queries)
- 📂 File system operations 
- 🔑 Registry modifications
- 🧩 Process creation and manipulation
- 📞 API calls from common Windows libraries

## 🛠️ Features

- **Controlled Sandbox**: Executes malware in an isolated environment
- **Network Traffic Analysis**: Uses `mitmproxy` to capture and analyze network communications
- **API Monitoring**: Leverages `Frida` to hook into important Windows APIs
- **Process Tree Tracking**: Records process creation and relationships
- **File System Monitoring**: Detects file creation and modifications
- **Comprehensive Reporting**: Generates detailed JSON reports of all activities

## 🔧 Requirements

- Python 3.6+
- Windows environment (some functionality is Windows-specific)
- Administrator privileges

### Dependencies

```
frida
mitmproxy
psutil
```

## 📥 Installation

1. Clone this repository:
   ```
   git clone https://github.com/Amr-Khaled-Ahmed/malware-analysis-tool.git
   cd malware-analysis-tool
   ```

2. Install the required dependencies:
   ```
   pip install -r requirements.txt
   ```

3. Configure your system proxy settings to use 127.0.0.1:8080 if you want to capture network traffic.

## ⚙️ Configuration

Edit the main script to configure:

- `MALWARE_PATH`: Path to the malware sample you want to analyze
- `ANALYSIS_DURATION`: How long (in seconds) the analysis should run

## 🚀 Usage

1. Place your malware sample in the appropriate location
2. Update the `MALWARE_PATH` variable in the script
3. Run the analysis:
   ```
   python malware_analysis.py
   ```

⚠️ **WARNING**: Only run this tool in a controlled environment such as a virtual machine. Never analyze malware on production systems!

## 📊 Output

The tool generates comprehensive reports in the following formats:

- **JSON Report**: `report.json` containing all collected data
- **Log File**: `malware_analysis.log` with runtime information

### Sample Report Structure

```json
{
  "metadata": {
    "analysis_start": "2025-04-18T12:00:00",
    "analysis_duration": "00:00:30",
    "malware_path": "/path/to/malware.exe",
    "system_info": { ... }
  },
  "network": {
    "urls_accessed": [ ... ],
    "dns_queries": [ ... ],
    "http_requests": [ ... ],
    "https_requests": [ ... ]
  },
  "system": {
    "api_calls": [ ... ],
    "created_files": [ ... ],
    "registry_operations": [ ... ],
    "process_operations": [ ... ]
  },
  "process_tree": [ ... ],
  "artifacts": [ ... ]
}
```

## 🔍 Analysis Workflow

1. A sandbox directory is created for containment
2. The mitmproxy is started to capture network traffic
3. The malware is executed in the controlled environment
4. Frida hooks into the process to monitor API calls
5. File system changes are monitored in real-time
6. After the analysis duration, all processes are terminated
7. A comprehensive report is generated

## 🛡️ Security Considerations

- Always use this tool in an isolated environment
- Consider using a virtual machine with no network connection to the internet
- Be aware that some malware may detect analysis tools and change behavior
- Never run unknown malware samples on critical systems

## 📝 Extending the Tool

You can extend the capabilities by:

- Adding more API hooks in the `FRIDA_SCRIPT` constant
- Implementing additional artifact collection methods
- Creating custom report formats
- Adding machine learning-based classification of behaviors

## 🤝 Contributing

Contributions are welcome! Please feel free to submit a Pull Request.

## 📄 License

This project is licensed under the MIT License - see the LICENSE file for details.

## 🙏 Acknowledgments

- Frida project for the powerful instrumentation toolkit
- mitmproxy team for the excellent traffic analysis tool
- All contributors to the open-source security community

---

⚠️ **Disclaimer**: This tool is for educational and research purposes only. Use responsibly and ethically.
